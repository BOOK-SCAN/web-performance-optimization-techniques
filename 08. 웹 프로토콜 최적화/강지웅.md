# 📝 Contents

## HTTP의 발전
### HTTP/1.1
- HTTP/1.1은 HTTP의 첫 번째 공식 표준 버전
- GET, POST 외에도 DELETE를 통해 파일 업로드하거나 웹 서버의 내용 삭제도 가능
- Via 헤더를 사용해 중계 서버 정보 공유
- Accept 헤더로 클라이언트가 어떤 형식의 콘텐츠를 지원하는지 미리 서버에 알릴 수 있다.
- 파이프라이닝 기술: 브라우저가 웹 서버에 여러 개의 콘텐츠를 요청했을 때, 이전 요청에 대한 응답을 완전하게 받지 않더라도 지속적 연결로 확보한 하나의 TCP 연결 내에서 미리 다음 요청에 대한 처리를 시작하면서 전체적인 전달 시간을 줄일 수 있다.
- 주고받는 통신에는 순서가 있으므로 HOL(Head-Of-Line blocking) 문제가 발생할 수 있다.

### HTTP/2
- HTTP/1.1보다 개선된 웹 프로토콜을 만들기 위해 시작한 SPDY 프로젝트
  + SPDY: 'speedy'라는 단어를 기반으로 Google이 만든 조어로, Google이 자신들의 'Make the Web Faster' 노력의 하나로 제안한 새로운 프로토콜
  + HTTP/1.1과 HTTP/2의 중단 단계 프로토콜
- 텍스트 방식의 프로토콜 메시지를 과감히 버리고 이진 포맷을 사용하면서 프로토콜 자체를 경량화하려고 시도했다.
- HTTP/1.1 기능에 멀티플렉싱, 스트림 우선순위 설정, 헤더 압축, 서버 푸시 같은 새로운 프로토콜 최적화 기능이 추가되었다.
- HTTP의 HOL 문제는 해결할 수 있었지만 TCP의 HOL 문제는 해결하지 못했다.

### HTTP/3
- 새로운 인터넷 프로토콜인 QUIC을 사용하는 HTTP 최상위 버전이다.
- QUIC의 가장 큰 특징은 UDP를 사용한다는 점이다.
  + UDP 프로토콜 구조가 최적화를 진행하기 더 쉬운 형태이기 때문에 사용
- 클라이언트와 HTTP/3 서버 사이에 한 번 맺은 QUIC 연결을 최대한 재사용하는 구조이므로 클라이언트와 서버 간 연결을 만드는 과정에서 소모되는 시간이 대폭 줄어들었다.

## HTTP/2의 최적화 기술
- HTTP/2의 가장 큰 목표는 클라이언트와 서버가 콘텐츠를 주고받는 시간을 줄이고, 서버 응답이 느린 콘텐츠가 다른 정상적인 콘텐츠의 전달을 방해하지 않도록 하는 것
  + 이를 위해 기존 문자열 방식의 프로토콜을 이진 프레임으로 바꾸어 프로토콜을 좀 더 가볍고 유연하게 만들었다.
  + HTTP 요청과 응답에 포함된 중복 헤더 값들은 걸러내고, 전송해야 하는 값을 기존과 다르게 압축해 헤더의 크기를 최소화했다.
  + 서버 푸시를 통해 클라이언트가 요청하지 않은 콘텐츠도 서버가 미리 빠르게 전송하여 RTT를 더욱 최소화했다.

### HTTP/2의 이진 프레임
- 이진 프레임을 이해하기 위해서는 먼저 HTTP가 어떻게 구성되었는지 알아야 한다.
- HTTP/2 이전 버전에서의 HTTP의 요청과 응답은 메시지라는 단위로 구성되어 있었다. HTTP의 메시지는 상태 라인, 헤더와 페이로드로 이루어져 요청과 응답에 필요한 정보를 담고 있다.
- HTTP/2에는 기존 HTTP/1.1 버전의 메시지 단위 외에도 프레임, 스트림이라는 단위가 추가되었다.
  + 프레임: HTTP/2 통신상 제일 작은 정보 단위이며 헤더나 데이터 중 하나
  + 메시지: HTTP/1.1 마찬가지로 요청 혹은 응답 단위이며 다수의 프레임으로 이루어졌다.
  + 스트림: 클라이언트와 서버 사이 맺어진 연결을 통해 양방향으로 주고받는 하나 혹은 복수의 메시지
  + 즉, 여러 개의 프레임이 모여 메시지가 되고 여러 개의 메시지가 모여 스트림이 되는 구조
- HTTP/1.1에서 요청과 응답은 하나의 메시지가 각 오브젝트의 요청과 응답을 담당했지만 HTTP/2에서는 하나의 스트림이 다수의 요청을 포함하고 이에 대한 다수의 응답 정보를 포함하는 구조로 바뀌었다. 스트림 방식을 사용함으로써 동시 요청 및 응답할 수 있는 오브젝트의 개수가 많아졌다.
- HTTP/2 에서는 하나의 TCP 연결을 통해 다수의 클라이언트 요청과 서버 응답이 비동기 방식으로 이루어지는 멀티플렉싱이 사용된다. 이를 통해 HTTP/1.1의 HOL 문제가 자연스레 해결된 것이다.

### 멀티플렉싱
- 멀티플렉싱은 HTTP/1.1의 파이프라이닝 기능을 개선한 것이다. 파이프라이닝 기능은 선입 선출 방식을 사용하여 다음 콘텐츠들이 대기 상태로 있어야 했다. 그러나 HTTP/2의 스트림이 가진 유연한 구조 덕분에 응답 프레임들은 요청 순서에 상관없이 클라이언트에 전달될 수 있다.
- 멀티플렉싱: 스트림을 사용하여 웹 서버에서 나중에 요청 받았더라도 전달할 수 있는 경우 클라이언트에게 먼저 전달하는 구조

### 헤더 압축
- HTTP/2는 클라이언트와 서버 사이에 가상 테이블을 만들어서 동일하고 중복되는 헤더 값들을 테이블에 저장하고 참고하는 방식을 사용해 중복 전달을 제거하였다.
- 헤더 압축 알고리즘인 HPACK을 사용해 허프만 알고리즘 방식으로 헤더를 압축하여 좀 더 경량의 데이터를 주고받을 수 있게 되었다.
  + 허프만 알고리즘: 자주 등장하는 값과 그렇지 않은 값마다 코드 값을 다르게 부여하는 알고리즘

### 서버 푸시
- HTTP/2에는 클라이언트가 특정 콘텐츠를 요청하면 서버는 이후 추가될 요청을 미리 예상하고 요청 없이도 응답하는 서버 푸시 기능이 추가되었다.
- 서버 푸시 대상은 웹 서버 관리자나 개발자가 미리 정할 수 있다.

## HTTP/3의 최적화 기술
- HTTP/3을 이해하려면 먼저 QUIC을 알아야한다.
- QUIC은 구글이 개발한 OSI 레이어 중 네번째 계층에 해당하는 전달 계층 프로토콜이다.

### QUIC
- QUIC는 UDP를 채택해 TCP의 성능을 개선하려는 기술이다.
- 전달 속도와 향상과 더불어 클라이언트와 서버의 연결 수를 최소화하고 대역폭을 예상해 패킷 혼잡을 피하는 것이 QUIC의 주요 특징이다.
- 이전에 클라이언트가 한 번이라도 접속했던 서버라면, 별도의 정보 교환없이 바로 데이터를 보내는 기술, 즉 Zero RTT를 소개하였다.

### HTTP/3의 등장 배경
- HTTP/3은 새로운 기능을 추가하기보다 QUIC이라는 UDP 기반의 프로토콜을 사용해 TCP가 가지고 있는 HTTP/2의 단점을 보완하는 데 중점을 두었다.

### HTTP/3의 특징
- 가장 큰 특징은 TCP/IP 기반 애플리케이션 레이어 프로토콜인 HTTP를 QUIC 위로 위치시켰다는 것이다. 이를 'HTTP over QUIC', 줄여서 HQ라고 한다.
- HTTP/3은 HTTP/2의 TCP HOL 문제만 개선한 것이 아니라 HTTP/2의 모든 기능을 계승해 UDP의 빠른 성능, QUIC의 효율성, TLS 1.3의 보안성까지 모든 장점을 가진다.

### HTTP/3을 지원하는 제품군
- HTTP/3을 사용하려면 웹 브라우저와 웹 서버, 즉 클라이언트와 서버 모두 HTTP/3 프로토콜을 지원해야 한다.
- 제품군: LiteSpeed, proxygen 라이브러리, mvfst 라이브러리, 에지 브라우저, Cloudflare, 크롬 브라우저의 카나리아 버전, Nginx 등

### 새로운 프로토콜 적용 시 고려할 점
- 새로운 IT 기술을 먼저 적용할 경우 대두되는 사안은 보안취약점과 사례의 부족이다.
- 최적화 방안을 수정해야한다. 브라우저의 프리페치를 적용한 경우에는 이를 서버 푸시 기능으로 변경해야할지 기술적으로 판단하고 충분한 성능 비교 테스트를 해야한다.
- 시장의 레퍼런스가 부족하다.
