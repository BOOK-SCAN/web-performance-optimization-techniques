# 📝 Contents

- 웹은 오늘날 전세계 사람들이 인터넷에 연결된 컴퓨터를 통해 수많은 정보를 공유할 수 있는 인터넷의 대표적 서비스
  + 인터넷과 동일하게 인식되기도 하기만 사실 웹은 인터넷이 제공하는 수많은 서비스 중 하나
- 웹이 개발되기 전에도 이미 TCP/IP 혹은 UDP를 이용한 클라이언트-서버 간 네트워크 통신 또는 소켓 네트워크 기술을 사용하여 데이터 교환이 가능했다.

### 웹의 대표적인 요소
#### URL(Uniform Resource Locator)
- 웹 자원이 인터넷상 어느 위치에 존재하고 있는지를 알려주는 방법
- URL의 구성과 의미는 다음 그림과 같다.
<img src="https://blog.kakaocdn.net/dn/o9tHQ/btrn1xNKWv2/vftLjaiam3lD69AzSz6syK/img.png" width="500" height="200"/>

- 그림에서는 HTTP를 사용하고 있지만, 보안 요소를 추가한 HTTPS 프로토콜도 존재한다.
- 디렉터리는 웹 자원을 효율적으로 구분하는 기준을 바탕으로, 디렉터리만 봐도 어떤 카테고리의 콘텐츠에 접근 중인지 알 수 있도록 명시적으로 생성해야 한다.
- 실제 경로(파일) 부분에는 일반적으로 대소문자를 혼용하지 않으며 파일 확장자는 존재할 수도 있고 경로로만 위치를 알려줄 수도 있다.

#### 네트워크 프로토콜
- HTTP는 정보를 주고받는 헤더 부분과 실제 데이터를 주고받는 페이로드 부분으로 크게 나뉘어 있다.
  + 웹페이지의 내용에 해당하는 부분을 페이로드 또는 바디라고 부르기도 한다.
- HTTP 프로토콜은 웹에서 클라이언트와 서버 사이에 필요한 정보는 헤더로 주고받고, HTML이나 이미지 같은 실제 데이터는 페이로드 부분에 받을 수 있도록 설계되었다.

#### HTML
- HTML은 다양한 웹상의 콘텐츠를 브라우저를 통해 나타낼 수 있는 태그(tag)라는 명령어로 웹의 목적에 맞는 여러 기능을 수행한다.
- 마크업 언어의 일종이다.
- HTML로 작성된 웹 페이지는 HTTP 기반 네트워크를 통해 웹 서버에서 웹 브라우저로 전달되고, 웹 브라우저는 HTML을 해석하여 웹 페이지 화면을 만들어 사용자에게 제공한다.

### 웹 성능이 중요한 이유
- **웹 성능은 콘텐츠가 신속하게 전달되어 사용자가 원하는 서비스를 빠르게 전달받을 수 있도록 하는 시스템들의 성능, 쉽게 말해 웹 로딩 시간을 이야기 한다.**
  + 웹 사이트의 기능이나 내용을 의미하는 것이 아니다.
- 3초의 법칙: 3초 안에 웹 사이트에 접속한 사용자의 관심을 끌어야 한다는 법칙.

### 웹 성능 측정 방법
- 웹 성능을 측정하는 방법을 이해하려면 먼저 웹 성능에 영향을 주는 요소를 파악해야 하고 이를 측정할 수 있는 적절한 도구를 선택해야 한다.
  + 사용자 환경: 거주 지역과 어떤 네트워크 장비, 브라우저를 사용하는지 환경이 각각 다르다.
  + 공급자 환경: DNS 네임 서버 응답 속도, 웹 서버 응답 속도, 웹 사이트의 백엔드 처리 속도, 프론트엔트 최적화 여부가 접속자의 로딩 시간에 영향을 준다.
  + 전달 환경: 웹 서버가 위치한 데이터 센터가 자체 전용선을 보유했는지 그리고 유선망과 모바일망에 각각의 서버를 배포했는지에 따라서도 품질이 달라질 수 있다.
- 웹 성능을 측정할 수 있는 대표적인 서비스들은 다음과 같다.
  + 크롬 브라우저의 개발자 도구
  + WebPageTest(WPT) 서비스
    + 세계 여러 위치에서 웹 사이트 로딩 속도를 테스트할 수 있는 무료 서비스로, 해당 지역의 테스터가 없다더라도 테스트할 수 있는 환경을 제공한다.
  + 구글 PageSpeed

### 웹 성능을 만드는 지표
- 3절에서 웹 성능을 좌우하는 3가지 대표적 항목(사용자 환경, 공급자 환경, 전달 환경)을 좀 더 단순하게 보면 프론트엔드와 백엔드로 나눌 수 있다.
- 프론트엔드와 백엔드 각 환경에 대해 자세히 알아보자.

#### 사용자 환경 - 프론트엔드
- 프론트엔드: 사용자가 브라우저를 사용하여 보는 화면 자체를 의미하며 빠르고 보기 쉽게 콘텐츠를 전달하는 것이 프론트엔드의 가장 큰 목적이다.

#### 공급자 환경- 백엔드
- 백엔드: 사용자에게 보이는 프론트엔드 콘텐츠를 실제 생산하고 저장하여 네트워크를 통해 전달한다. 
- 데이터베이스, 라우터, 네트워크 스위치도 대표적인 백엔드 요소로 프론트엔드가 최적화되어 있는데도 웹 성능이 좋지 않다면 백엔드 최적화도 점검해야 한다.

#### 전달 환경 - 네트워크
- 프론트엔드, 백엔드와 달리 네트워크는 장소와 시간에 따라 속도가 변하기 때문에 성능 측정이 어렵다.
- 일반적으로 네트워크 성능을 제약하는 두 가지 요소는 '대역폭'과 '지연 시간'이다.
  + 대역폭: 일정 시간에 처리할 수 있는 트래픽 양. 사용자가 갑작스럽게 증가하면 웹 콘텐츠의 전달 속도를 느리게 만들 수 있다.
  + 지연 시간: 기술적 이유로 사용자에게 콘텐츠를 전달하지 못하고 지원되는 시간

### 웹 성능과 프론트엔드
- **프론트엔드는 데이터를 표현하는 역할뿐만 아니라 사용자가 입력한 다양한 형태의 데이터를 백엔드에 전달하는 역할도 한다.**
- 대다수의 웹 사이트의 웹 성능을 측정해보면 사이트를 로딩할 때 프론트엔드에서 가장 많은 시간을 소요한다.
  + '사용자(브라우저) 관점에서 원하는 콘텐츠를 전달받았는지'가 웹 성능의 기준이기 때문
- 구글의 PageSpeed나 크롬 브라우저 개발자 도구의 Lighthouse 기능 등으로 성능을 확인하고 테스트할 수 있다.

#### 웹 성능 예산
- 웹 성능이 비지니스의 성패를 좌우하는 경우가 많다.
- 웹 성능을 계량할 수 있도록 수치화하여 기업의 목표로 삼을 때 많이 사용하는 방법 중 하나가 **웹 성능 예산**이다.
- 성능 예산은 웹 성능에 영향을 미치는 다양한 요소를 제어하는 한곗값으로, 크게 다음 세 가지 분류로 나눌 수 있다.

#### 정량 기반 지표
- 이미지, 스크립트, 폰트 등 웹 페이지 제작에 필요한 요소들에 대한 한곗값으로, 대표적인 정량 기반 지표는 다음과 같다.
  + 이미지 파일의 최대 크기
  + 최대 웹 폰트 파일 개수
  + 자바스크립트 파일 크기 합
  + 타사 스크립트 개수 합
- 그러나 많은 변수가 있기 때문에 단순히 파일 크기를 줄이고 파일의 개수를 줄였다 해서 웹 성능이 좋아질 것이란 보장은 없다.

#### 시간 기반 지표
- DOMContentLoaded, Load와 같이 브라우저에서 실제로 발생하는 다양한 웹 성능 이벤트 값을 측정하여 사용주가 느끼는 웹 성능에 대한 목표치를 설정하는 방식으로, 대표적인 시간 기반 지표는 다음과 같다.
  + FCP: 텍스트 또는 이미지와 같이 DOM의 첫 번재 비트를 표시하는 시점
  + TTI: 페이지가 사용자 입력에 안정적으로 응답하는 데 걸리는 시간

#### 규칙 기반 지표
- 웹 성능 측정 도구들은 자체적으로 웹 성능 지표를 측정하여 각 사이트의 성능 점수를 매기는 알고리즘을 갖고 있다.또한 측정 결과를 통해 어떻게 최적화를 진행해야 하는지 기술적 첨언도 해준다.
- 대표적인 규칙 기반 지표는 다음과 같다.
  + WebPageTest의 성능 점수
  + 구글 Lighthouse의 성능 점수
- 정령 기반 지표와 시간 기반 지표를 개선할수록 규칙 기반 지표 점수는 높아진다.

#### 성능 예산 활용
- 웹 페이지는 업데이트가 잦기 때문에 콘텐츠의 변화로 인해 웹 성능 요소가 변경될 수 있으며 성능 예산을 벗어나는 작업이 필요할 수 있다.
- 따라서 최근에는 형상 관리 및 새로운 버전을 빌드한 후 배포 이전에 최종 성능 예산을 측정하고 관리하는 방법도 사용한다.

# 💭 Insights

### DOMContentLoaded와 Load?
- HTML 문서의 생명주기엔 다음과 같은 3가지 주요 이벤트가 관여한다.
  + DOMContentLoaded : 브라우저가 HTML을 전부 읽고 DOM 트리를 완성하는 즉시 발생 이미지 파일(<img>)이나 스타일시트 등의 기타 자원은 기다리지 않는다.
    + 브라우저는 HTML 문서를 처리하는 도중에 <script> 태그를 만나면, DOM 트리 구성을 멈추고 <script>를 실행, 스크립트 실행이 끝난 후에야 나머지 HTML 문서를 처리
    + <script>에 있는 스크립트가 DOM 조작 관련 로직을 담고 있을 수 있기 때문에 이런 방지책
    + 따라서 DOMContentLoaded 이벤트 역시 <script> 안에 있는 스크립트가 처리되고 난 후에 발생
  + load : HTML로 DOM 트리를 만드는 게 완성되었을 뿐만 아니라 이미지, 스타일시트 같은 외부 자원도 모두 불러오는 것이 끝났을 때 발생
  + beforeunload/unload : 사용자가 페이지를 떠날 때 발생

#### 이벤트 활용 예시
- DOMContentLoaded: DOM이 준비된 것을 확인한 후 원하는 DOM 노드를 찾아 핸들러를 등록해 인터페이스를 초기화할 때
- load : 이미지 사이즈를 확인할 때 등. 외부 자원이 로드된 후이기 때문에 스타일이 적용된 상태이므로 화면에 뿌려지는 요소의 실제 크기를 확인할 수 있음
- beforeunload: 사용자가 사이트를 떠나려 할 때, 변경되지 않은 사항들을 저장했는지 확인시켜줄 때
- unload: 사용자가 진짜 떠나기 전에 사용자 분석 정보를 담은 통계자료를 전송하고자 할 때

##### 출처
- https://nyol.tistory.com/167
